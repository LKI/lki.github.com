<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Hugo 0.82.0" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="Lirian Su" />
  <meta property="og:url" content="https://liriansu.com/posts/2017-08-30-lazy-coding-thinking/" />
  <link rel="canonical" href="https://liriansu.com/posts/2017-08-30-lazy-coding-thinking/" /><script type="application/ld+json">
  {
      "@context" : "https://schema.org",
      "@type" : "BlogPosting",
      "mainEntityOfPage": {
           "@type": "WebPage",
           "@id": "https:\/\/liriansu.com\/"
      },
      "articleSection" : "posts",
      "name" : "写代码怎么偷懒？我想想",
      "headline" : "写代码怎么偷懒？我想想",
      "description" : "\u003cp\u003e我真的不是因为写了\u003ccode\u003ePython\u003c\/code\u003e，就在黑\u003ccode\u003ePerl\u003c\/code\u003e。\u003c\/p\u003e",
      "inLanguage" : "en-US",
      "author" : "Lirian Su",
      "creator" : "Lirian Su",
      "publisher": "Lirian Su",
      "accountablePerson" : "Lirian Su",
      "copyrightHolder" : "Lirian Su",
      "copyrightYear" : "2017",
      "datePublished": "2017-08-30 23:10:52 \u002b0000 UTC",
      "dateModified" : "2017-08-30 23:10:52 \u002b0000 UTC",
      "url" : "https:\/\/liriansu.com\/posts\/2017-08-30-lazy-coding-thinking\/",
      "keywords" : [  ]
  }
</script>
<title>写代码怎么偷懒？我想想 - 浮云计算</title>
  <meta property="og:title" content="写代码怎么偷懒？我想想 - 浮云计算" />
  <meta property="og:type" content="article" />
  <meta name="description" content="我真的不是因为写了Python，就在黑Perl。" />

  <link rel="stylesheet" href="/css/flexboxgrid-6.3.1.min.css" />
  <link rel="stylesheet"
    href="/css/github-markdown.min.css" />
  <link rel="stylesheet" href="/css/highlight/tomorrow.min.css" />
  <link rel="stylesheet" href="/css/index.css">
  <link href="/index.xml" rel="alternate" type="application/rss+xml" title="浮云计算">
  
  <link href="https://fonts.googleapis.com/css?family=Arvo|Permanent+Marker" rel="stylesheet">
  
  

  
</head>


<body>
  <article class="post 中文" id="article">
    <div class="row">
      <div class="col-xs-12 col-sm-10 col-md-8 col-sm-offset-1 col-md-offset-2 col-lg-6 col-lg-offset-3">
        <div class="site-header">
          <header>
  <div class="signatures site-title">
    <a href="/">Lirian Su</a>
  </div>
</header>
<div class="row end-xs site-header-right">
  
  <div class="site-header-item">
    <a href="/about" target="_blank">about</a>
  </div>
  
  <div class="site-header-item">
    <a href="https://github.com/LKI" target="_blank">github</a>
  </div>
  
  <div class="site-header-item">
    <a href="https://www.zhihu.com/people/liriansu" target="_blank">zhihu</a>
  </div>
  
  <div class="site-header-item">
    <a href="/index.xml" target="_blank">rss</a>
  </div>
  
</div>
<div class="header-line"></div>

        </div>
        <header class="post-header">
          <h1 class="post-title">写代码怎么偷懒？我想想</h1>
          
          <div class="row post-desc">
            
            <time class="post-header-item" datetime="2017-08-30 23:10:52 UTC">
              Written at 2017-08-30 23:10
            </time>
            
            <span class="post-header-item" id="busuanzi_container_page_pv"> Views <span id="busuanzi_value_page_pv" /> </span>
          </div>
          
        </header>

        <div class="post-content markdown-body">
          <p>我真的不是因为写了<code>Python</code>，就在黑<code>Perl</code>。</p>

<h2 id="起">起</h2>

<p>最近装了 <a href="https://wakatime.com/dashboard">wakatime</a> 这个控件以后，<br />
我一直忍不住好奇心去看看我平常到底有多少时间在写代码。<br />
经过严谨的数据统计表明：<br />
我只有25%的时间在写代码。<br />
（按一周40小时算，<br />
我一周只写10小时的代码=_,=）</p>

<p><img src="/assets/pics/wakatime_dashboard.jpg" alt="old-waka" /></p>

<p>这样不好。<br />
于是我决定奋发图强，<br />
在自以为沉浸地写了一周代码以后，<br />
25%变成了33%。<br />
于是严谨的数据统计依然表明：<br />
我大部分的时间都在划水。</p>

<p><img src="/assets/pics/wakatime.png" alt="new-waka" /></p>

<p>于是我放弃了挣扎，<br />
就像苏轼朋友佛印和尚讲过的一样：<br />
<code>既来之，则安之</code> <em>不是他说的</em></p>

<p>我很开心地想道：<br />
“哎呀。<br />
我就花这么一点点时间干活，<br />
是不是说明我效率高呀？”</p>

<p>“不是的，只不过是因为你懒而已。”<br />
心里的正义小人蹦了出来。</p>

<p>我十分开心地嘴硬道：<br />
“对呀对呀，我就是懒。<br />
而且就像我以前说的，<br />
懒有那种没有建设性的懒，<br />
还有那种一劳永逸的懒。”</p>

<p>嗯，今天我就要尝试说服我心里的正义小人，<br />
<strong>我不是在偷懒，我是在想问题！</strong></p>

<p>按老规矩，<br />
用讲故事的方式讲道理。<br />
献丑了！</p>

<h2 id="承">承</h2>

<p>我从大四到毕业，<br />
一直在<a href="https://www.qad.com/about">QAD</a>当研发（就是研发工程师）<br />
一般来说，“研发工程师”这个说法是分工上这么叫的，<br />
洋文里叫 <code>SE, Software Engineer</code>,<br />
对应测试工程师 <code>QA, Quality Assurance</code>。<br />
互联网公司里是Web编程的话，<br />
会从另一个维度上分成前端工程师 <code>FE, Front End</code>,<br />
后端工程师 <code>BE, Back End</code>。<br />
有些也会从部门上拆分成架构、技术（业务）、算法、数据不同的组。</p>

<p><a href="https://www.qad.com/about">QAD</a>主要是按业务拆分研发部门，<br />
我们当时是Foundation组（基础架构组）。<br />
公司做的是SaaS形式的ERP系统。（SAP, Oracle都是我们的竞争对手）<br />
这里的SaaS可以简单理解为年费会员，<br />
大众(Volkswagen)公司买QAD的ERP系统并不是一锤子买卖，<br />
当合同签订以后，<br />
我们还要负责整套系统的安装、培训、维护、升级工作。<br />
（当然大众也要对应地交“物业费”就是了）<br />
公司部门分工大概如下：</p>

<ul>
<li>R&amp;D 负责开发软件。R&amp;D也就是研发部门，Research and Development, 我在这…<br /></li>
<li>Sales 负责销售产品。（有的时候研发还没做完，产品就卖出去了，于是倒催研发…十分神奇…<br /></li>
<li>Service 负责产品的安装、上线、培训。有的时候客户有一些定制化的需求，Service也是要写代码的。比如中国的医药公司要开发一套药监局审查流程，这个明显不是标准流程，就需要<strong>定制化开发</strong>。<br /></li>
<li>Support 负责日常的支持。比如产品平时出Bug了，晚上出Bug了，周末出Bug了，都要负责给客户解决…<br /></li>
<li>Finance, Law, HR, CEO 等其他队友提供内部支持，维系组织有序运转。<br />
<br /></li>
</ul>

<p>我当时参与的项目是叫<code>CVC, Customer Version Control</code>。<br />
要解决的问题，就是<strong>定制化开发中的，代码版本控制难题。</strong><br />
比如还是大众公司，<br />
他们2008年就安装了QAD2008版本，<br />
然后基于2008版本做了大量关于车辆测试、车辆安全性能等方面的定制化开发。<br />
于是在QAD要升级主程序版本的时候，<br />
大众公司惊呼：<a href="https://xkcd.com/1597/">“1079 Merge Conflicts Found!!!”</a><br />
这种定制化和主干的冲突，<br />
只是当时我们要解决的其中一个问题，<br />
其它还包括有超过10G的代码本地环境构建，<br />
dev-test-sup-prod多环境代码管理，<br />
soft/hard lock等。</p>

<h2 id="转">转</h2>

<p>正义小人：“ok，于是你讲了这么多，<br />
跟具体写程序相关的一句话没讲……”</p>

<p>的确，具体写程序的话是一句没讲。<br />
那既然都扯这么多了，<br />
我就再扯多点吧…</p>

<p>技术选型上，最开始用了 <code>Git</code> + <code>Perl</code>。<br />
因为要做代码版本控制，<br />
所以核心的轮子就用了<code>Git</code>，<br />
当时团队的技术栈主要是<code>Git vs SVN</code>，<br />
又因为要做多环境管理，<br />
所以<code>git rebase</code>, <code>git cherry-pick</code>, <code>git filter-branch</code>等一串能修改历史的命令就优势明显。<br />
又因为整个项目最终是一个命令行工具，<br />
而且团队之前的主要技术栈是<code>Perl</code>，<br />
<a href="https://www.tiobe.com/tiobe-index/">项目语言就采用了<code>Perl</code></a>。<br />
<code>Perl</code>这门语言最强大是它的命令行交互和文本处理，<br />
很多<code>shell</code>命令是天生共通的，<br />
比如<code>echo, test -f, $@</code>等；<br />
文本处理上，正则和一些<code>heredoc</code>也是非常美妙。<br />
而<code>Perl</code>最大的问题倒不在<a href="https://coolshell.cn/articles/1903.html">语言本身被诟病的鬼画符</a>上，<br />
最大的问题是：<code>Perl</code>日渐衰弱。<br />
比如假如我们说我们招<code>Java</code>工程师，<br />
那其实可以招到很多人才，<br />
但同样招<code>Perl</code>工程师，<br />
招到同样人才的概率也不一定会高很多，<br />
但是付出的成本要高更多。</p>

<p>于是后来我干了一件事情，<br />
下班时间用<code>Java</code>把<code>CVC</code>给重写了。<br />
三四月份的上海特别凉快，<br />
我住的离公司也近，<br />
六点多吃完饭，走路回家洗个澡，<br />
穿个拖鞋就蹦跶回公司。<br />
白天写<code>Perl</code>，晚上写<code>Java</code>，特别开心。<br />
当时老大也特别会顺势而为，<br />
他看我自己在重构项目，<br />
分给我的活也更少了，<br />
于是后来上班的时间我也在“划水”写<code>Java</code>了。<br />
因为需求明确，功能点清晰，<br />
就这样过了两个月，<br />
两万行的<code>Perl</code>代码再加同样量级的单元测试，<br />
（一时间竟没找到比代码行数更恰当的数据……）<br />
被我重构了一半到<code>Java</code>&hellip;<br />
后来大家一起把各种Edge Case补上了，<br />
整个产品正式切换成了<code>Java</code>，<br />
也算是一点微小的贡献吧。</p>

<h2 id="合">合</h2>

<p>我在QAD的时间(2014年7月到2016年10月)<br />
基本上都贡献给了CVC这个项目。<br />
同样的功能，<br />
<code>Perl</code>版本用了一年多实现，<br />
<code>Java</code>版本用了几个月就实现了。<br />
决定性因素跟语言表现力毫无关系，<br />
而在于<code>业务需求</code>和<code>业务理解</code>上。</p>

<p>正如上文介绍项目流程里讲的，<br />
项目要做的是<strong>定制化开发</strong>，<br />
需求就是来自于<strong>Service</strong>部门同事。<br />
他们一开始是不知道什么样的软件是好用的，<br />
我们定义好的产品模式（比如自由checkout文件），<br />
但是他们觉得另一种模式更好（开发人员更换频繁，需要对文件加soft lock），<br />
或者是觉得产品可以更好（比如流程要和Jira高度结合）。<br />
所以其实我们在<code>Design - Refine</code>这个流程上不断进步<br />
（中文的说法叫“走了不少弯路”）</p>

<p>还有我们在重构过程中，<br />
因为知道了整体的需求的样子，<br />
就能更好地抽象逻辑。<br />
就像是建筑师设计房子的时候，<br />
因为知道了整体架构，<br />
他才能确定房梁的承重，<br />
部件的用材。</p>

<p>正义小人想了想，说：<br />
“噢，我明白了。你的意思是说，<br />
偷懒不写程序，其实只是停笔，<br />
想想要写什么样的程序？<br />
需求更准确，理解更清晰，事情才会更好做？”</p>

<p>“对呀对呀！满分理解！”</p>

<p>正义小人又一脸嫌弃：<br />
“但是现实生活中，是不会有这样的情况的。”</p>

<p>是呀，所以我也只能一边说着“学到了学到了”，<br />
一边想着“我是谁，我在哪，我要写什么程序？”</p>
        </div>

        
          

          
          <div style="height: 20px;"></div>
        

        



<div class="post-comments">
  <script src="https://utteranc.es/client.js"
          repo="LKI/lki.github.io"
          issue-term="title"
          label="comment"
          theme="github-light"
          crossorigin="anonymous"
          async>
  </script>
</div>


        

<div class="site-footer">
  <div class="site-footer-left">
    <div class="site-footer-item">
      <span id="busuanzi_container_site_pv" style="display:none"> PV: <span id="busuanzi_value_site_pv"/> </span>
    </div>
    <div class="site-footer-item">
      <span id="busuanzi_container_site_uv" style="display:none"> UV: <span id="busuanzi_value_site_uv"/> </span>
    </div>
  </div>

  <div class="site-footer-right">
    
    
    <div class="site-footer-item">
      <a href="/en/">English</a>
    </div>
    
    
  </div>
</div>

      </div>
    </div>
  </article>

  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

</body>

</html>
